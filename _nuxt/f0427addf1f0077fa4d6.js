(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{436:function(n,e,t){"use strict";e.a=[{aid:"work-in-do1",title:"二零一八",date:"20190214",tags:["work"],desc:"关于2018年这一年来的工作痕迹"},{aid:"webpack-optimization",title:"webpack构建速度优化",date:"20180704",tags:["webpack"],desc:"实践是检验真理的唯一标准"},{aid:"trap-in-job",title:"项目中遇到的坑...",date:"20180711",tags:["webpack"],desc:"关于升级到webpack4.x遇到的问题"},{aid:"prerender-spa-plugin",title:"单页面预渲染实践",date:"20181205",tags:["webpack"],desc:"通过prerender-spa-plugin实现单页面预渲染"},{aid:"php-learning",title:"php学习笔记",date:"20160911",tags:["php","后端"],desc:"php是世界上最好的语言？？？"},{aid:"webpack-learning",title:"webpack学习",date:"20160820",tags:["webpack"],desc:"记录第二次学习webpack"},{aid:"git-actions",title:"关于git的所接触的一些操作",date:"20160814",tags:["git"],desc:"Git是目前世界上最先进的分布式版本控制系统，嗯！"},{aid:"ssh-key",title:"配置ssh-key",date:"20160804",tags:["SSH-Key"],desc:"如何配置SSH-Key"}]},437:function(n,e,t){n.exports=t.p+"img/489ced3.jpg"},438:function(n,e,t){"use strict";t(73),t(26),t(27),t(17);var a=t(75),i=t.n(a),c={save:function(n,e){var t=new(i.a.Object.extend(n));return e&&e.map(function(n){t.set(n.key,n.value)}),new Promise(function(n,e){t.save().then(function(e){var t={oid:e.id,data:e.attributes};n(t)},function(n){e(n)})})},select:{contains:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=new i.a.Query(n);return c.contains(e.key,e.value),c.limit(t),a&&c.skip(a),this.core(c)},greaterThanOrEqualTo:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=new i.a.Query(n);return c.greaterThanOrEqualTo(e.key,e.value),c.limit(t),a&&c.skip(a),this.core(c)},equalTo:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"descending",s=new i.a.Query(n);if(e instanceof Array){var l=!0,o=!1,u=void 0;try{for(var v,d=e[Symbol.iterator]();!(l=(v=d.next()).done);l=!0){var h=v.value;s.equalTo(h.key,h.value)}}catch(n){o=!0,u=n}finally{try{l||null==d.return||d.return()}finally{if(o)throw u}}}else s.equalTo(e.key,e.value);return s[c]("createdAt"),s.limit(t),a&&s.skip(a),this.core(s)},countTotal:function(n,e){var t=new i.a.Query(n);if(e instanceof Array){var a=!0,c=!1,s=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var u=l.value;t.equalTo(u.key,u.value)}}catch(n){c=!0,s=n}finally{try{a||null==o.return||o.return()}finally{if(c)throw s}}}else t.equalTo(e.key,e.value);return new Promise(function(n,e){t.count().then(function(e){n(e)},function(n){e(n)})})},core:function(n){return new Promise(function(e,t){n.find().then(function(n){var t={};t=n.length>0?{ok:!0,data:n.map(function(n){return{oid:n.id,attributes:n.attributes,updatedAt:n.updatedAt.toLocaleString()}})}:{ok:!1},e(t)},function(n){t(n)})})}},update:function(n,e,t){var a=i.a.Object.createWithoutData(n,e);t.map(function(n){a.set(n.key,n.value)}),a.save()},count:function(n,e,t){return new Promise(function(a,c){var s=i.a.Object.createWithoutData(n,e);s.set(t.key,t.value),s.save().then(function(n){return n.increment(t.key,1),n.fetchWhenSave(!0),n.save()}).then(function(n){console.log(123333,n),a(n.attributes[t.key])},function(n){c(n)})})}};e.a=c},439:function(n,e,t){"use strict";t.d(e,"a",function(){return a}),t.d(e,"b",function(){return i}),t.d(e,"c",function(){return c});var a="Articles",i="Comments",c="Likes"},448:function(n,e,t){"use strict";t.r(e);t(17),t(74);var a=t(12),i=t.n(a),c=t(6),s=t.n(c),l=(t(54),t(13)),o=t.n(l),u=t(442),v=t.n(u),d=t(40),h=t(76),g=t(438),f=t(436),m=t(439),k={name:"articles-details",asyncData:function(){var n=o()(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.params,n.abrupt("return",{article:f.a.filter(function(n){return n.aid===t.id})[0]});case 2:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),data:function(){return{oid:{articlesTable:null,commentsTable:null,likesTable:null},toc:{data:[],index:0,levelIndex:0,lastLevel:null,topLevel:null},content:{toc:null,markdown:"",activeTocItem:0},likes:0,comment:null,commentList:[],pagination:{total:0},isLoadingContent:!1,isLoadingComments:!1,isLiked:!1}},created:function(){this.lcQueryArticlesById(),this.lcCountCommentsTotal(),this.lcQueryComments(1,10),this.lcQueryLikes()},beforeMount:function(){var n=this;this.getMarkdownFile();var e=new v.a.Renderer;e.heading=function(e,t,a){var i=n.tocAdd(e,t);return"<a id=".concat(i,' class="anchor-fix"></a><h').concat(t,">").concat(e,"</h").concat(t,">\n")},v.a.setOptions({renderer:e})},beforeDestroy:function(){this.$store.commit("articles/setPageView","--"),this.$store.commit("articles/setPageCollection",!1)},computed:s()({},Object(d.b)(["isAuthenticated","loggedUser"]),{hasComments:function(){return this.commentList.length>0}}),methods:{tocAdd:function(n,e){var t=this.toc,a=t.index,i=t.lastLevel,c=t.topLevel;this.toc.index=i===e?a:0,c&&c!==e||(this.toc.levelIndex++,this.toc.topLevel=e),this.toc.lastLevel=e;var s=this.toc.levelIndex,l="toc".concat(e).concat(s).concat(++this.toc.index);return this.toc.data.push({anchor:l,level:e,text:n,index:s}),l},tocToHtml:function(){for(var n=this.toc.data,e=[],t=0;t<n.length;t++){n.activeIndex=t;var a=n[t].index;e[a-1]?e[a-1].children.push(n[t]):e[a-1]=s()({},n[t],{children:[]})}this.content.toc=e},getMarkdownFile:function(){var n=this;this.isLoadingContent=!0;var e="/posts/".concat(this.$route.params.id,"/index.md");this.$axios.get(e).then(function(e){n.isLoadingContent=!1,n.content.markdown=v()(e.data),n.tocToHtml()}).catch(function(e){n.isLoadingContent=!1,console.log(e)})},handleLoginInGithub:function(){var n=Object(h.a)().authorizeURL;window.open(n,"_blank","titlebar=false, status=false, location=false, toolbar=false, scrollbars=false, width=500, height=720")},handleLike:function(){var n=this;if(this.isAuthenticated){var e=this.$route.params.id;this.isLiked?this.$gnoz.alertMsg("嘻嘻，赞了不给取消！"):g.a.select.equalTo(m.a,{key:"aid",value:e}).then(function(e){if(e.ok){var t=e.data[0],a=t.oid,i=t.attributes;n.lcCountArticle(a,i.likes,"likes").then(function(e){g.a.update(m.c,n.oid.likesTable,[{key:"isLiked",value:!0}]),n.likes=e,n.isLiked=!0})}})}else this.$gnoz.alertMsg("请先登录！","warning")},handleComment:function(){var n=this;this.oid&&this.comment&&g.a.save(m.b,[{key:"aid",value:this.$route.params.id},{key:"comment",value:this.comment}].concat(i()(Object.keys(this.loggedUser).map(function(e){return{key:e,value:n.loggedUser[e]}})))).then(function(e){n.$gnoz.alertMsg("评论成功！"),n.comment=null,n.lcCountCommentsTotal(),n.lcQueryComments(1,10)}).catch(function(e){n.$gnoz.alertMsg("评论失败！","danger")})},lcQueryArticlesById:function(){var n=this,e=this.$route.params.id;g.a.select.equalTo(m.a,{key:"aid",value:e}).then(function(e){if(e.ok){var t=e.data[0],a=t.oid,i=t.attributes;n.lcCountArticle(a,i.pv,"pv").then(function(e){n.$store.commit("articles/setPageView",e)}),n.oid.articlesTable=a,n.likes=i.likes}else n.lcSaveArticle()})},lcCountCommentsTotal:function(){var n=this,e=this.$route.params.id;g.a.select.countTotal(m.b,{key:"aid",value:e}).then(function(e){n.pagination.total=e})},lcQueryComments:function(n){var e=this,t=n.currentPage,a=n.pageSize;t--,this.isLoadingComments=!0;var i=this.$route.params.id;g.a.select.equalTo(m.b,{key:"aid",value:i},a,t*a).then(function(n){e.isLoadingComments=!1,n.ok&&(e.commentList=n.data.map(function(n){return s()({},n.attributes,{updatedAt:n.updatedAt})}))})},lcQueryLikes:function(){var n=this;if(this.isAuthenticated){var e=this.$route.params.id;g.a.select.equalTo(m.c,[{key:"aid",value:e},{key:"userId",value:this.loggedUser.id}]).then(function(t){if(t.ok){var a=t.data[0].oid,i=t.data[0].attributes,c=i.isLiked,s=i.isCollected;n.oid.likesTable=a,n.isLiked=c,n.$store.commit("articles/setPageCollection",s),n.$store.commit("articles/setLikesTableOid",a)}else g.a.save(m.c,[{key:"aid",value:e},{key:"userId",value:n.loggedUser.id},{key:"isLiked",value:!1},{key:"isCollected",value:!1}]).then(function(e){var t=e.oid;n.oid.likesTable=t,n.$store.commit("articles/setLikesTableOid",t)})})}},lcCountArticle:function(n,e,t){return g.a.count(m.a,n,{key:t,value:e})},lcSaveArticle:function(){var n=this;g.a.save(m.a,[].concat(i()(Object.keys(this.article).map(function(e){return{key:e,value:n.article[e]}})),[{key:"pv",value:1},{key:"likes",value:0}]))}}},p=t(1),y=Object(p.a)(k,function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"article_details"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:{isLoading:n.isLoadingContent,title:"加载中···"},expression:"{isLoading: isLoadingContent, title: '加载中···'}"}]},[a("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"markdown_content",domProps:{innerHTML:n._s(n.content.markdown)}})]),n._v(" "),a("div",{staticClass:"actions_content"},[a("dy-button",{attrs:{type:"danger",size:"large",outline:""},on:{click:n.handleLike}},[a("i",{staticClass:"fa",class:n.isLiked?"fa-heart":"fa-heart-o"}),n._v(" "),a("span",{staticStyle:{"margin-right":"10px"}},[n._v("喜欢")]),n._v("\n      "+n._s(n.likes)+"\n    ")]),n._v(" "),a("dy-button",{attrs:{type:"warning",size:"large"}},[a("i",{staticClass:"fa fa-rmb"}),n._v("\n      支持\n    ")])],1),n._v(" "),a("div",{staticClass:"comments_content"},[a("dy-row",[a("dy-col",{attrs:{span:"2"}},[n.isAuthenticated?a("img",{attrs:{src:n.loggedUser.avatar_url,alt:"avatar"}}):a("img",{attrs:{src:t(437),alt:"avatar"}})]),n._v(" "),a("dy-col",{attrs:{span:"22"}},[a("dy-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:"140",placeholder:"到此一游？",disabled:!n.isAuthenticated,rows:"6"},model:{value:n.comment,callback:function(e){n.comment="string"==typeof e?e.trim():e},expression:"comment"}})],1),n._v(" "),a("dy-col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[n.isAuthenticated?a("dy-button",{attrs:{type:"primary"},on:{click:n.handleComment}},[n._v("评论")]):a("dy-button",{attrs:{type:"danger"},on:{click:n.handleLoginInGithub}},[n._v("登录后可评论")])],1)],1),n._v(" "),a("h3",[n._v("\n      全部评论\n      "),a("span",[n._v(n._s(n.pagination.total)+"条")])]),n._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:{isLoading:n.isLoadingComments,title:"评论加载中···"},expression:"{isLoading: isLoadingComments, title: '评论加载中···'}"}]},[a("ul",{staticClass:"comments_content_list"},[n.hasComments?n._e():a("li",{staticClass:"t-empty-data"},[a("dy-icon",{attrs:{type:"no-data"}}),n._v(" "),a("p",[n._v("暂无评论")])],1),n._v(" "),n._l(n.commentList,function(e,t){return a("li",{key:t},[a("div",[a("img",{attrs:{src:e.avatar_url,alt:"avatar"}}),n._v(" "),a("span",[n._v(n._s(e.name))]),n._v(" "),a("time",[n._v(n._s(e.updatedAt))])]),n._v(" "),a("div",{staticClass:"comments_content_details"},[n._v(n._s(e.comment))])])})],2),n._v(" "),n.hasComments?a("dy-pagination",{attrs:{"show-page-size":"",total:n.pagination.total},on:{"page-change":n.lcQueryComments}}):n._e()],1)],1)])},[],!1,null,null,null);y.options.__file="_id.vue";e.default=y.exports}}]);